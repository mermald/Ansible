---
- name: Install rhn-client-tools
  yum:
    name: rhn-client-tools
    state: present

- name: Install rhn-check
  yum:
    name: rhn-check

- name: Install rhn-setup
  yum:
    name: rhn-setup

- name: Install rhnsd
  yum:
    name: rhnsd

- name: Install m2crypto
  yum:
    name: m2crypto

- name: Install yum-rhn-plugin
  yum:
    name: yum-rhn-plugin

- name: Install epel-release
  yum:
    name: epel-release
    state: present

- name: Install Spacewalk repo
  command:
    name: "rpm -Uvh http://yum.spacewalkproject.org/2.3/RHEL/7/x86_64/spacewalk-repo-2.3-4.el7.noarch.rpm"
        
- name: Register system with Spacewalk
  command:
    name: "rhnreg_ks --serverUrl=http://spacewalk.sphere.us/XMLRPC --activationkey=1-a679786505204c5e376b342386bd5aba"
